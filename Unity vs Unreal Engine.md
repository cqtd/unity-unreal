# Unity vs Unreal Engine

## 개발 단계

### 에셋 관리 방법

리소스를 게임 엔진에서 사용할 수 있는 포맷으로 변경하여야 메모리에 올려 로드를 할 수 있다. 프로젝트 개발 단계에서

#### 유니티

에셋을 프로젝트에 임포트하면 Raw Data를 항상 유지하고 있다. 그러면 어떻게 미리 에셋을 엔진에서 사용할 수 있도록 가공해두는걸까? 프로젝트의 Assets 폴더에 리소스를 넣게 되면, 임포트 설정을 해당 파일의 meta에 저장한다. 그리고 그 임포트 설정으로 Library 폴더에 데이터를 Cache해둔다. 외부 툴에서 프로젝트내의 폴더로 곧바로 리소스를 저장해 덮어쓰기를 하더라도, 지정되어있던 임포트 설정에 따라 새로운 Cache가 생성된다.

![image-20201222202153752](images\image-20201222202153752.png)![image-20201222202240870](images\image-20201222202240870.png)

![image-20201222202335833](images\image-20201222202335833.png)

#### 언리얼

에셋을 프로젝트에 Import 하면 `uasset` 확장자의 파일로 저장된다. Raw Data를 임포트된 파일 내에 저장하고 있는 경우도 있지만 그렇지 않기도 하다. 하나의 리소스 파일이 항상 하나의 `uasset`으로 전환되지는 않는다. 외부 툴에서 리소스를 작업할 때, 파일을 언리얼 프로젝트 내 콘텐츠 폴더에 바로 저장하지 않고, 외부 경로에 저장한 뒤 엔진 내에서 임포트 과정을 해 주어야 한다. 기존경로에서 바로 리임포트하는 기능을 제공하고 있어, 파일을 수정하는 경우 이전에 임포트했던 파일경로에 저장해 두면 개발 사이클의 속도 향상을 꾀할 수 있다.

- `rigging`된 fbx를 `SkeletalMesh`로 임포트하면, `SkeletalMesh`, `PhysicsAsset`, `Skeleton` 최소 3가지 에셋이 생성된다.

  ![image-20201222201453261](images\image-20201222201453261.png)

- source file의 경로를 저장하고 있어, `3ds max` 같은 모델링 툴에서 수정 후 source file 의 위치에 덮어쓰기로 저장한 뒤 리임포트하면 새로운 파일을 받아온다.

  ![image-20201222201624077](images\image-20201222201624077.png)

### 에셋 참조 관리

에셋간에도 종속성이 존재할 수 있다. 예를 들어 `머티리얼`은 `텍스쳐`를 바꿔낄 수 있게 설계되있고, `텍스쳐`가 바뀔 때 그를 저장할 수단이 있어야 한다. 리소스들은 대부분 이런 관계를 갖고 있고, 데이터를 중복되지 않게 재사용해야하기에 에셋을 참조할 Unique한 무언가가 필요하다.

#### 유니티

`guid` 기반으로 동작한다. `guid`는 각 파일의 `meta` 파일에 저장되어 있다. 모든 참조는 `guid`를 통해 저장되며, `meta` 파일을 삭제해버리면 참조가 깨어져 구성해둔 프리팹이 망가지기도 한다. 협업과정에서 `meta` 파일을 빼고 공유해 프로젝트 전체가 뭉개지는 경우도 발생하니 주의해야한다. 엔진이 에셋 참조를 따로 관리해주지 않는다. 어떤 `머티리얼`이 특정한 `텍스쳐`를 사용할 때, 이 `텍스쳐`를 프로젝트에서 제거하려고 시도해도, 엔진은 아무런 경고나 주의도 주지 않으니 조심해 삭제할 필요가 있다. 따로 인덱싱을 해두고 있지 않다.

#### 언리얼

경로를 거의 그대로 사용한다. 다만 파일을 삭제할 때, 역 레퍼런스를 검사할 수 있다. 위 유니티와의 비슷한 경우로 어딘가에서 사용되는 에셋을 지우려 할 경우 어떤 곳에서 사용되고 있는지 알려준다. 모든 에셋으로부터 알려주는 것은 아니며, 현재 로드된 패키지로부터만 검사가 가능해 완벽하지는 않은 기능이다. `리디렉터`라는 시스템이 있다. 에셋의 경로를 변경하고나면, 이 에셋을 참조하고 있던 에셋을 로드할 때 이 에셋이 사라져 문제가 발생할 수 있을 것이다. 이를 방지하기 위해, 옮겨지기 전 원본 위치에 `리디렉터`라는 것을 엔진이 남겨준다. 로드되지 않은 상태에서 에셋이 옮겨간 경우 나중에 다시 로드 될 때, 이 리디렉터를 보고 에셋이 어디로 옮겨갔는지 알 수 있게된다.

https://docs.unrealengine.com/ko/ProductionPipelines/Redirectors/index.html